{
  "scenarioName": "CRUD event",
  "steps": [
    {
      "name": "initDataBeforeTest",
      "url": "com.varb.schedule.integration.TestSqlExecutor",
      "operation": "executeSqlScript",
      "request": "db/scripts/zerocode/initEventTest.sql",
      "assertions": {}
    },
    {
      "name": "add_event",
      "url": "/api/event",
      "operation": "POST",
      "request": {
        "headers": {
          "Accept": "application/json;charset=UTF-8"
        },
        "body": {
          "unitId": 200,
          "dateFrom": "2019-11-20",
          "note": "описание",
          "eventTypeId": 1
        }
      },
      "assertions": {
        "status": 200,
        "body": {
          "eventId": "$NOT.NULL",
          "duration": "$EQ.5",
          "unitId": "$EQ.${$.add_event.request.body.unitId}",
          "dateFrom": "${$.add_event.request.body.dateFrom}",
          "note": "${$.add_event.request.body.note}",
          "eventTypeId": "$EQ.${$.add_event.request.body.eventTypeId}"
        }
      }
    },

    {
      "name": "put_event",
      "url": "/api/event/${$.add_event.response.body.eventId}",
      "operation": "PUT",
      "request": {
        "headers": {
          "Accept": "application/json;charset=UTF-8"
        },
        "body": {
          "unitId": 300,
          "dateFrom": "2019-11-21",
          "note": "noteChanged",
          "eventTypeId": 2
        }
      },
      "assertions": {
        "status": 200,
        "body": {
          "eventId": "$EQ.${$.add_event.response.body.eventId}",
          "duration": "$EQ.6",
          "unitId": "$EQ.${$.put_event.request.body.unitId}",
          "dateFrom": "${$.put_event.request.body.dateFrom}",
          "note": "${$.put_event.request.body.note}",
          "eventTypeId": "$EQ.${$.put_event.request.body.eventTypeId}"
        }
      }
    },

    {
      "name": "get_event",
      "url": "/api/event?dateFrom=2019-07-20",
      "operation": "GET",
      "request": {
        "headers": {
          "Accept": "application/json;charset=UTF-8"
        }
      },
      "assertions": {
        "status": 200,
        "body": [
          {
            "eventId": "$EQ.${$.add_event.response.body.eventId}",
            "duration": "$EQ.${$.put_event.response.body.duration}",
            "unitId": "$EQ.${$.put_event.request.body.unitId}",
            "dateFrom": "${$.put_event.request.body.dateFrom}",
            "note": "${$.put_event.request.body.note}",
            "eventTypeId": "$EQ.${$.put_event.request.body.eventTypeId}"
          }
        ]
      }
    },

    {
      "name": "delete_event",
      "url": "/api/event/${$.add_event.response.body.eventId}",
      "operation": "DELETE",
      "request": {
        "headers": {
          "Accept": "application/json;charset=UTF-8"
        }
      },
      "assertions": {
        "status": 200
      }
    },

    {
      "name": "get_event_deleted",
      "url": "/api/event?dateFrom=2019-07-20",
      "operation": "GET",
      "request": {
        "headers": {
          "Accept": "application/json;charset=UTF-8"
        }
      },
      "assertions": {
        "status": 200,
        "body": "$[]"
      }
    },

    {
      "name": "clearDataAfterTest",
      "url": "com.varb.schedule.integration.TestSqlExecutor",
      "operation": "executeSqlScript",
      "request": "db/scripts/zerocode/cleanup.sql",
      "assertions": {}
    }
  ]
}
